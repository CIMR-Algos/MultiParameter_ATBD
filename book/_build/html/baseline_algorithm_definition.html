
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Baseline Algorithm Definition &#8212; ATBD Multi Parameter Retrieval</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Algorithm Input and Output Data Definition (IODD)" href="algorithm_input_output_data_definition.html" />
    <link rel="prev" title="Level-2 product definition" href="L2_product_definition.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ATBD Multi Parameter Retrieval</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    ATBD Multi Parameter Retrieval
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="abstract.html">
   Abstract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="acronyms.html">
   Acronyms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="definitions.html">
   Definitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="introduction_purpose_scope.html">
   Introduction, purpose and scope
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="background_justification_algorithm.html">
   Background and justification of selected algorithm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="L2_product_definition.html">
   Level-2 product definition
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Baseline Algorithm Definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="algorithm_input_output_data_definition.html">
   Algorithm Input and Output Data Definition (IODD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="algorithm_performance_assessment.html">
   Algorithm Performance Assessment (Version 2 ATBD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="OEM_SIT.html">
   OEM SIT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="annex.html">
   Annex
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/CIMR-Algos/ATBD-Template"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/baseline_algorithm_definition.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Baseline Algorithm Definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction">
     Introduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retrieval-method">
   Retrieval Method
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieval-definition">
     retrieval definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward-model">
     Forward Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#l-band-forward-model">
     L-band forward model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-template">
     from template
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cimr-level-1b-re-sampling-approach">
       CIMR Level-1b re-sampling approach
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#algorithm-assumptions-and-simplifications">
       Algorithm Assumptions and Simplifications
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#level-2-end-to-end-algorithm-functional-flow-diagram">
       Level-2 end to end algorithm functional flow diagram
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#functional-description-of-each-algorithm-step">
       Functional description of each Algorithm step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mathematical-description">
       Mathematical description
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#input-data">
       Input data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#output-data">
       Output data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#auxiliary-data">
       Auxiliary data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ancillary-data">
       Ancillary data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#validation-process">
       Validation process
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Baseline Algorithm Definition</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Baseline Algorithm Definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduction">
     Introduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#retrieval-method">
   Retrieval Method
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieval-definition">
     retrieval definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forward-model">
     Forward Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#l-band-forward-model">
     L-band forward model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-template">
     from template
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cimr-level-1b-re-sampling-approach">
       CIMR Level-1b re-sampling approach
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#algorithm-assumptions-and-simplifications">
       Algorithm Assumptions and Simplifications
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#level-2-end-to-end-algorithm-functional-flow-diagram">
       Level-2 end to end algorithm functional flow diagram
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#functional-description-of-each-algorithm-step">
       Functional description of each Algorithm step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mathematical-description">
       Mathematical description
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#input-data">
       Input data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#output-data">
       Output data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#auxiliary-data">
       Auxiliary data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ancillary-data">
       Ancillary data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#validation-process">
       Validation process
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="baseline-algorithm-definition">
<h1>Baseline Algorithm Definition<a class="headerlink" href="#baseline-algorithm-definition" title="Permalink to this headline">#</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>In the following the main algorithm for the multi parameter retrieval is
described in detail. The algorithm is based on the works of
<span id="id1">[<a class="reference internal" href="references.html#id8" title="Leif Toudal Pedersen. Retrieval of sea ice concentration by means of microwave radiometry. 1991.">Pedersen, 1991</a>, <a class="reference internal" href="references.html#id5" title="Raul Cristian Scarlat, Georg Heygster, and Leif Toudal Pedersen. Experiences with an optimal estimation algorithm for surface and atmospheric parameter retrieval from passive microwave data in the arctic. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing, 10(9):3934–3947, 2017. doi:10.1109/JSTARS.2017.2739858.">Scarlat <em>et al.</em>, 2017</a>, <a class="reference internal" href="references.html#id7" title="Raul Cristian Scarlat. Improving an optimal estimation algorithm for surface and atmospheric parameter retrieval using passive microwave data in the arctic. 2018. URL: https://media.suub.uni-bremen.de/handle/elib/1496.">Scarlat, 2018</a>, <a class="reference internal" href="references.html#id6" title="Raul Cristian Scarlat, Gunnar Spreen, Georg Heygster, Marcus Huntemann, Cătălin Paţilea, Leif Toudal Pedersen, and Roberto Saldo. Sea ice and atmospheric parameter retrieval from satellite microwave radiometers: synergy of AMSR2 and SMOS compared with the CIMR candidate mission. Journal of Geophysical Research: Oceans, 2020. doi:https://doi.org/10.1029/2019JC015749.">Scarlat <em>et al.</em>, 2020</a>]</span>. The algorithm is
divided into several steps, which are described in the following.</p>
<div class="mermaid">
            graph TD
	subgraph Input data
		subgraph CIMR L1b
			TBs[TBs]
			TBe[TB error]
		end
		subgraph External
			TEC[TEC]
			ECMWF[ECMWF analysis]
			ERA5[&quot;Historical ERA5&quot;]
		end
	end
	subgraph Inversion
		F[Forward model]
		cost[Cost function]
		apriori[A priori] 
		OS[Optimal state]

	end

	subgraph Output data L1R
		geo[Geophysical variables]
		unc[Geophsysical uncertainties]
		outtb[Grightness tempreature residuals]
	end

	resampling[Resampling processor L1R]
	icorr[Ionospheric correction]

	TBs --&gt; icorr
	TBe --&gt; icorr
	TEC --&gt; icorr


	icorr --&gt; resampling
	ECMWF --&gt; resampling
	resampling -- Measurement vector --&gt; cost
	resampling -- Measurement uncertainty --&gt; cost
	resampling -- State vector --&gt; apriori 
	resampling -- State uncertainty --&gt; apriori

	ERA5 --Covariance estimate--&gt; apriori
	apriori --&gt; cost
	F--&gt;cost
	cost--&gt;F

	cost --&gt; OS
	OS --&gt; geo
	OS --&gt; unc 
	OS --&gt; outtb
        </div></div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="retrieval-method">
<h1>Retrieval Method<a class="headerlink" href="#retrieval-method" title="Permalink to this headline">#</a></h1>
<div class="section" id="retrieval-definition">
<h2>retrieval definition<a class="headerlink" href="#retrieval-definition" title="Permalink to this headline">#</a></h2>
<p>The retrieval is following a typical scheme with the objective to minimize</p>
<div class="math notranslate nohighlight" id="equation-eq-chi2">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-chi2" title="Permalink to this equation">#</a></span>\[
\begin{align}
χ^2(\mathbf y,\mathbf x,\mathbf S_e,\mathbf S_a,\mathbf x_a) = \left(\mathbf y-F(\mathbf x)\right)^\mathbf{T}\mathbf S_e^{-1}(\mathbf
y-F(\mathbf x))+(\mathbf x_a-\mathbf x)^{\mathbf T}\mathbf S_a^{-1}(\mathbf x_a
- \mathbf x) 
\end{align}
\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-eqxy">
<span class="eqno">(2)<a class="headerlink" href="#equation-eqxy" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align}
\mathbf y= \begin{bmatrix}
T_{b,h,1.4}\\
T_{b,v,1.4}\\
T_{b,h,6.9}\\
T_{b,v,6.9}\\
T_{b,h,10.7}\\
T_{b,v,10.7}\\
T_{b,h,18.7}\\
T_{b,v,18.7}\\
T_{b,h,36.5}\\
T_{b,v,36.5}\\
\end{bmatrix}, \quad
\mathbf x= \begin{bmatrix}
\text{WSP}\\
\text{TWV}\\
\text{CLW}\\
\text{SST}\\
\text{IST}\\
\text{SIC}\\
\text{MYIF}\\
\text{SIT}\\
%\text{SSS}\\
\end{bmatrix}
\end{align}\end{split}\]</div>
<p>i.e., <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is the vector of input brightness temperatures (measurement vector) and
<span class="math notranslate nohighlight">\(\mathbf x\)</span> is the vector with the corresponding physical quantities (state
vector), <span class="math notranslate nohighlight">\(\mathbf S_e\)</span> is the error covariance matrix of the input brightness
temperatures, <span class="math notranslate nohighlight">\(\mathbf S_a\)</span> is the covariance matrix of the a priori values,
<span class="math notranslate nohighlight">\(\textbf x_a\)</span> is the a priori value, and <span class="math notranslate nohighlight">\(F\)</span> is the forward operator, which is
the compositional forward model described in <a class="reference internal" href="#fw-model"><span class="std std-ref">Forward Model</span></a>.  The optimal
solution <span class="math notranslate nohighlight">\(\hat {\mathbf y}\)</span> which minimizes equation <a class="reference internal" href="#equation-eq-chi2">(1)</a> is found by
iteration. The uncertainty of <span class="math notranslate nohighlight">\(\mathbf y\)</span> can then be obtained as</p>
<div class="math notranslate nohighlight" id="equation-eq-error">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-error" title="Permalink to this equation">#</a></span>\[\mathbf {\hat S}_a= (\mathbf S_a^{-1}+\mathbf{ \hat M}^\mathbf T \mathbf S_e^{-1}\mathbf {\hat M})^{-1}, \]</div>
<p>with <span class="math notranslate nohighlight">\(\mathbf {\hat M}\)</span> is the Jacobian of the optimal solution of
<a class="reference internal" href="#equation-eq-chi2">(1)</a>. The uncertainty of the individual parameters is then given by the
diagonal elements of <span class="math notranslate nohighlight">\(\mathbf {\hat S}_a\)</span>.</p>
</div>
<div class="section" id="forward-model">
<span id="fw-model"></span><h2>Forward Model<a class="headerlink" href="#forward-model" title="Permalink to this headline">#</a></h2>
<p>The Forward Model is the compositional forward model. It consists of individual
components, namely the ocean surface, the sea ice, and the atmosphere. At the
low frequency channels of the <a class="reference internal" href="acronyms.html#term-CIMR"><span class="xref std std-term">CIMR</span></a> satellite, the sensitivity to
atmospheric parameters is relatively small, but nevertheless the atmosphere
needs to be considered.
The forward model for Ocean and Atmosphere for frequencies 6.9, 10.7, 18.7, and 36.5 GHz is used from the AMSR2 ATBD from <span id="id2">[<a class="reference internal" href="references.html#id10" title="Fj Wentz and T Meissner. Algorithm theoretical basis document (atbd): amsr ocean algorithm (version 2). 2000. URL: http://scholar.google.com/scholar?hl=en&amp;btnG=Search&amp;q=intitle:Algorithm+Theoretical+Basis+Document+(+ATBD+)+AMSR+Ocean+Algorithm#2.">Wentz and Meissner, 2000</a>]</span>.
The surface contribution to the brightness temperature is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-surface">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-surface" title="Permalink to this equation">#</a></span>\[T_{b,s} = C_{\text{ow}}*ε_{\text{ow}}*T_{\text{ow}}+C_{\text{fyi}}*ε_{\text{fyi}}*T_{\text{fyi}}+C_{\text{myi}}*ε_{\text{myi}}*T_{\text{myi}},\]</div>
<p>where <span class="math notranslate nohighlight">\(C_{\text{ow}}\)</span>, <span class="math notranslate nohighlight">\(C_{\text{fyi}}\)</span>, and <span class="math notranslate nohighlight">\(C_{\text{myi}}\)</span> are the area
fraction of ocean water, first year ice, and multi year ice, respectively.
<span class="math notranslate nohighlight">\(ε_{\text{ow}}\)</span>, <span class="math notranslate nohighlight">\(ε_{\text{fyi}}\)</span>, and <span class="math notranslate nohighlight">\(ε_{\text{myi}}\)</span> are the emissivity of
ocean water, first year ice, and multi year ice, respectively. <span class="math notranslate nohighlight">\(T_{\text{ow}}\)</span>,
<span class="math notranslate nohighlight">\(T_{\text{fyi}}\)</span>, and <span class="math notranslate nohighlight">\(T_{\text{myi}}\)</span> are the brightness temperature of ocean
water, first year ice, and multi year ice, respectively. <span class="math notranslate nohighlight">\(C_{\text{ow}}\)</span>,
<span class="math notranslate nohighlight">\(C_{\text{fyi}}\)</span>, and <span class="math notranslate nohighlight">\(C_{\text{myi}}\)</span> are adding up to one. With the fruequency dependent emissivities
for first year ice and multi year ice derived by <span id="id3">[<a class="reference internal" href="references.html#id11" title="Nizy Mathew, Georg Heygster, and Christian Melsheimer. Surface emissivity of the arctic sea ice at amsr-e frequencies. IEEE Transactions on Geoscience and Remote Sensing, 47:4115-4124, 2009. doi:10.1109/TGRS.2009.2023667.">Mathew <em>et al.</em>, 2009</a>]</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-nizy">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-nizy" title="Permalink to this equation">#</a></span>\[U_{T, t, p}=(a_{t}*T_{C}+b_{t}+273.15)*ε_{t, p}\]</div>
<p>with <span class="math notranslate nohighlight">\(U_{t,h}\)</span> being the temperature corrected upwelling brightness temperature for the polarization <span class="math notranslate nohighlight">\(p\)</span>
at the air temperature at the surface <span class="math notranslate nohighlight">\(T_{C}\)</span> (in °C), <span class="math notranslate nohighlight">\(a_{t}\)</span> and <span class="math notranslate nohighlight">\(b_{t}\)</span> are the frequency
dependent coefficients from <span id="id4">[<a class="reference internal" href="references.html#id11" title="Nizy Mathew, Georg Heygster, and Christian Melsheimer. Surface emissivity of the arctic sea ice at amsr-e frequencies. IEEE Transactions on Geoscience and Remote Sensing, 47:4115-4124, 2009. doi:10.1109/TGRS.2009.2023667.">Mathew <em>et al.</em>, 2009</a>]</span> (see <a class="reference internal" href="annex.html#tab-emtemp"><span class="std std-numref">Table 7</span></a>), and
<span class="math notranslate nohighlight">\(ε_{t,p}\)</span> is the frequency dependent emissivity for the polarization <span class="math notranslate nohighlight">\(p\)</span> from <a class="reference internal" href="annex.html#tab-c-ice"><span class="std std-numref">Table 5</span></a></p>
<p>The ice thickness dependence at all frequencies is introduced via modification of the emission from the ice surface.
The ice emissivity is modified by the ice thickness <span class="math notranslate nohighlight">\(\text{SIT}\)</span> according to</p>
<div class="math notranslate nohighlight" id="equation-eq-ice-thickness">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-ice-thickness" title="Permalink to this equation">#</a></span>\[T_{b,p} = a_{p}-(a_{p}-b_{p})*\exp\left(-\frac{\text{SIT}}{c_{p}}\right)\]</div>
<p>with the index <span class="math notranslate nohighlight">\(p\)</span> indicate polarization (<span class="math notranslate nohighlight">\(h\)</span> or <span class="math notranslate nohighlight">\(v\)</span>) the coefficients <span class="math notranslate nohighlight">\(a_{p}\)</span>,
<span class="math notranslate nohighlight">\(b_{p}\)</span>, and <span class="math notranslate nohighlight">\(c_{p}\)</span> from <span id="id5">[<a class="reference internal" href="references.html#id6" title="Raul Cristian Scarlat, Gunnar Spreen, Georg Heygster, Marcus Huntemann, Cătălin Paţilea, Leif Toudal Pedersen, and Roberto Saldo. Sea ice and atmospheric parameter retrieval from satellite microwave radiometers: synergy of AMSR2 and SMOS compared with the CIMR candidate mission. Journal of Geophysical Research: Oceans, 2020. doi:https://doi.org/10.1029/2019JC015749.">Scarlat <em>et al.</em>, 2020</a>]</span> (see <a class="reference internal" href="annex.html#tab-fy-thick"><span class="std std-numref">Table 6</span></a>). To
combine ice temperatuer and ice thickness dependence, the ice emissivity is
modified by the ice thickness  by substituting <span class="math notranslate nohighlight">\(a_{p}\)</span> with the ice temperature
dependent <span class="math notranslate nohighlight">\(U_{T, t, p}\)</span> from <a class="reference internal" href="#equation-eq-nizy">(5)</a> for <span class="math notranslate nohighlight">\(t=\text{FYI}\)</span>. This was not performed in
<span id="id6">[<a class="reference internal" href="references.html#id6" title="Raul Cristian Scarlat, Gunnar Spreen, Georg Heygster, Marcus Huntemann, Cătălin Paţilea, Leif Toudal Pedersen, and Roberto Saldo. Sea ice and atmospheric parameter retrieval from satellite microwave radiometers: synergy of AMSR2 and SMOS compared with the CIMR candidate mission. Journal of Geophysical Research: Oceans, 2020. doi:https://doi.org/10.1029/2019JC015749.">Scarlat <em>et al.</em>, 2020</a>]</span> but is essential for the minimization of the cost function
to not introduce discontinuities in the forward model. The MYI emissivity is not
affected by the ice thickness in this forward model, as it was not part of the
thickness sensitivity study in <span id="id7">[<a class="reference internal" href="references.html#id6" title="Raul Cristian Scarlat, Gunnar Spreen, Georg Heygster, Marcus Huntemann, Cătălin Paţilea, Leif Toudal Pedersen, and Roberto Saldo. Sea ice and atmospheric parameter retrieval from satellite microwave radiometers: synergy of AMSR2 and SMOS compared with the CIMR candidate mission. Journal of Geophysical Research: Oceans, 2020. doi:https://doi.org/10.1029/2019JC015749.">Scarlat <em>et al.</em>, 2020</a>]</span>.</p>
<p>To get back to emissivity in order to account for the atmospheric contribution
to the brightness temperatures at surface level, the brightness temperature is just devided by the ice surface temperature</p>
<div class="math notranslate nohighlight" id="equation-eq-ist">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-ist" title="Permalink to this equation">#</a></span>\[ε_p = \frac{T_{b,p}}{\text{IST}}\]</div>
<p>With
<span class="math notranslate nohighlight">\(C_{\text{myi}}+C_{\text{fyi}}=\text{SIC}\)</span> and <span class="math notranslate nohighlight">\(\text{SIC}*C_\text{myi} =
\text{MYIF}\)</span> being part of the state vector <a class="reference internal" href="#equation-eqxy">(2)</a>, the state defines
the surface area fraction of all three considered surface types.</p>
<p>The reflectivity of
the surface, <span class="math notranslate nohighlight">\(R_{\text{surf}}\)</span>, is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-surfref">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-surfref" title="Permalink to this equation">#</a></span>\[R_{\text{surf}} = 1 -
ε_{\text{ow}}*C_{\text{ow}} - ε_{\text{fyi}}*C_{\text{fyi}} -
ε_{\text{myi}}*C_{\text{myi}}.\]</div>
<p>The atmospheric contribution to the brightness temperature is calculated from
the parametrization from <span id="id8">[<a class="reference internal" href="references.html#id10" title="Fj Wentz and T Meissner. Algorithm theoretical basis document (atbd): amsr ocean algorithm (version 2). 2000. URL: http://scholar.google.com/scholar?hl=en&amp;btnG=Search&amp;q=intitle:Algorithm+Theoretical+Basis+Document+(+ATBD+)+AMSR+Ocean+Algorithm#2.">Wentz and Meissner, 2000</a>]</span>. They fitted the donwelling and
upwelling effective temperature using a least squares fit to the <a class="reference internal" href="acronyms.html#term-TWV"><span class="xref std std-term">TWV</span></a>.
The fit is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-atm">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-atm" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align}
T_D=b_0+b_1V+b_2V^2+b_3V^3+b_4V^4+b_5\zeta(T_s-T_v)\\
D_U=T_D+b_6+b7V\\
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_v = 273.16+0.8337 V - 3.029\cdot 10^{-5}V^{3.33}\)</span> for V&lt;48 and
<span class="math notranslate nohighlight">\(T_v=301.16\)</span> for V&gt;48 and <span class="math notranslate nohighlight">\(\zeta(x)=1.05x*(1-x^2)/1200\)</span> for <span class="math notranslate nohighlight">\(|x|&lt;20\ \text{K}\)</span> and
<span class="math notranslate nohighlight">\(\zeta(x)=\text{sign}(x)*14\ \text{K}\)</span> for <span class="math notranslate nohighlight">\(|x|&gt;20\ \text{K}\)</span>.</p>
<p>The absorption by oxygen is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-abs-oxy">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-abs-oxy" title="Permalink to this equation">#</a></span>\[A_o = a_{O1}+a_{O2}(T_{D}-270)\]</div>
<p>The vapor absorption is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-abs-vap">
<span class="eqno">(11)<a class="headerlink" href="#equation-eq-abs-vap" title="Permalink to this equation">#</a></span>\[A_V = a_{V1}V+a_{V2}V^2\]</div>
<p>The liquid water absorption is given by</p>
<div class="math notranslate nohighlight" id="equation-eq-abs-liq">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-abs-liq" title="Permalink to this equation">#</a></span>\[A_L = a_{L1}(x-a_{L2}(T_L - 283))L\]</div>
<p>with <span class="math notranslate nohighlight">\(L\)</span> being the liquid water path.</p>
<p>The total atmospheric attenuation is given by a combination of the individual terms as from <a class="reference internal" href="#equation-eq-abs-oxy">(10)</a>, <a class="reference internal" href="#equation-eq-abs-vap">(11)</a>, and <a class="reference internal" href="#equation-eq-abs-liq">(12)</a>:</p>
<div class="math notranslate nohighlight" id="equation-eq-abs-tot">
<span class="eqno">(13)<a class="headerlink" href="#equation-eq-abs-tot" title="Permalink to this equation">#</a></span>\[\tau = \exp\left(-\frac{A_o+A_V+A_L}{\cos\theta}\right)\]</div>
<p>with <span class="math notranslate nohighlight">\(\theta\)</span> being the incidence angle.</p>
</div>
<div class="section" id="l-band-forward-model">
<h2>L-band forward model<a class="headerlink" href="#l-band-forward-model" title="Permalink to this headline">#</a></h2>
<p>The addition for 1.4GHz was done by <span id="id9">[<a class="reference internal" href="references.html#id6" title="Raul Cristian Scarlat, Gunnar Spreen, Georg Heygster, Marcus Huntemann, Cătălin Paţilea, Leif Toudal Pedersen, and Roberto Saldo. Sea ice and atmospheric parameter retrieval from satellite microwave radiometers: synergy of AMSR2 and SMOS compared with the CIMR candidate mission. Journal of Geophysical Research: Oceans, 2020. doi:https://doi.org/10.1029/2019JC015749.">Scarlat <em>et al.</em>, 2020</a>]</span> and is based on <span id="id10">[<a class="reference internal" href="references.html#id9" title="Christopher S. Ruf. Vicarious calibration of an ocean salinity radiometer from low earth orbit. Journal of Atmospheric and Oceanic Technology, 20:1656-1670, 2003. doi:10.1175/1520-0426(2003)020&lt;1656:VCOAOS&gt;2.0.CO;2.">Ruf, 2003</a>]</span>.</p>
</div>
<div class="section" id="from-template">
<h2>from template<a class="headerlink" href="#from-template" title="Permalink to this headline">#</a></h2>
<div class="section" id="cimr-level-1b-re-sampling-approach">
<h3>CIMR Level-1b re-sampling approach<a class="headerlink" href="#cimr-level-1b-re-sampling-approach" title="Permalink to this headline">#</a></h3>
<p>Subsection Text</p>
</div>
<div class="section" id="algorithm-assumptions-and-simplifications">
<h3>Algorithm Assumptions and Simplifications<a class="headerlink" href="#algorithm-assumptions-and-simplifications" title="Permalink to this headline">#</a></h3>
<p>Subsection Text</p>
</div>
<div class="section" id="level-2-end-to-end-algorithm-functional-flow-diagram">
<h3>Level-2 end to end algorithm functional flow diagram<a class="headerlink" href="#level-2-end-to-end-algorithm-functional-flow-diagram" title="Permalink to this headline">#</a></h3>
<p>Subsection Text</p>
</div>
<div class="section" id="functional-description-of-each-algorithm-step">
<h3>Functional description of each Algorithm step<a class="headerlink" href="#functional-description-of-each-algorithm-step" title="Permalink to this headline">#</a></h3>
<p>Subsection Text</p>
</div>
<div class="section" id="mathematical-description">
<h3>Mathematical description<a class="headerlink" href="#mathematical-description" title="Permalink to this headline">#</a></h3>
<p>SubSubsection Text</p>
</div>
<div class="section" id="input-data">
<h3>Input data<a class="headerlink" href="#input-data" title="Permalink to this headline">#</a></h3>
<p>SubSubsection Text</p>
</div>
<div class="section" id="output-data">
<h3>Output data<a class="headerlink" href="#output-data" title="Permalink to this headline">#</a></h3>
<p>SubSubsection Text</p>
</div>
<div class="section" id="auxiliary-data">
<h3>Auxiliary data<a class="headerlink" href="#auxiliary-data" title="Permalink to this headline">#</a></h3>
<p>SubSubsection Text</p>
</div>
<div class="section" id="ancillary-data">
<h3>Ancillary data<a class="headerlink" href="#ancillary-data" title="Permalink to this headline">#</a></h3>
<p>SubSubsection Text</p>
</div>
<div class="section" id="validation-process">
<h3>Validation process<a class="headerlink" href="#validation-process" title="Permalink to this headline">#</a></h3>
<p>SubSubsection Text</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="L2_product_definition.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Level-2 product definition</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="algorithm_input_output_data_definition.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Algorithm Input and Output Data Definition (IODD)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By CIMR Devalgo<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>